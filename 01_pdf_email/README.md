# PDF Email 提取工具

自动遍历文件夹中的所有PDF文件，提取作者Email地址，生成Excel报告。

## 功能特点

- ✅ 递归搜索所有子文件夹中的PDF文件
- ✅ 自动提取PDF中的Email地址
- ✅ 跳过超过30MB的大文件
- ✅ 生成详细的Excel报告
- ✅ 路径自动转换为Windows格式
- ✅ 超大文件以黄色背景标注

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

或手动安装：

```bash
pip install PyPDF2 openpyxl
```

### 2. 运行脚本

将脚本复制到包含PDF文件的文件夹，然后运行：

```bash
python generate_excel.py
```

### 3. 查看结果

脚本会在当前目录生成 `PDF_Email提取报告.xlsx`

## 使用场景

### 场景1：处理单个文件夹

```bash
# 进入目标文件夹
cd "D:\我的PDF文件"

# 运行脚本
python generate_excel.py
```

### 场景2：处理包含子文件夹的项目

```bash
# 在项目根目录运行
cd "D:\我的项目"
python generate_excel.py

# 脚本会自动搜索所有子文件夹
```

## 输出说明

### Excel工作表1：所有PDF文件

包含以下列：
- 序号
- 文件名
- 所在文件夹（相对路径）
- 文件夹完整路径（Windows格式）
- 文件完整路径（Windows格式）
- 文件大小(MB)
- 处理状态（已处理/跳过）
- Email地址
- Email数量
- 备注

**注意**：超过30MB的文件会以黄色背景标注

### Excel工作表2：统计汇总

- 总文件数
- 成功处理文件数
- 跳过文件数
- 提取到的Email总数
- 有Email的文件数
- 无Email的文件数
- 生成时间

## 系统要求

- Python 3.6 或更高版本
- 支持 Windows / Linux / Mac
- 依赖库：PyPDF2, openpyxl

## 注意事项

1. **大文件限制**：默认跳过超过30MB的PDF文件（可在脚本中修改 `MAX_SIZE_MB` 变量）
2. **路径格式**：在Linux/WSL环境下运行时，会自动将路径转换为Windows格式
3. **Email提取**：只扫描PDF前5页（通常作者信息在前面）
4. **中文支持**：完全支持中文文件名和路径

## 自定义配置

在脚本中可以修改以下参数：

```python
# 文件大小限制（MB）
MAX_SIZE_MB = 30

# PDF扫描页数（提取Email时）
max_pages = min(5, len(pdf_reader.pages))
```

## 常见问题

**Q: 如何更改文件大小限制？**
A: 编辑脚本中的 `MAX_SIZE_MB = 30` 改为需要的值

**Q: 脚本会修改原PDF文件吗？**
A: 不会，脚本只读取PDF内容，不会修改任何文件

**Q: 如果没找到Email怎么办？**
A: Excel中会显示"未找到"，这是正常的（有些PDF可能不包含Email）

**Q: 支持加密的PDF吗？**
A: 不支持。加密的PDF会被跳过或显示处理失败

## 文件清单

- `generate_excel.py` - 主程序脚本
- `requirements.txt` - 依赖库清单
- `README.md` - 使用说明（本文件）

## 示例输出

```
开始处理PDF文件并生成Excel报告...
================================================================================
当前工作目录: D:\PDF文件夹
正在递归搜索所有子文件夹中的PDF文件...
================================================================================
找到 11 个PDF文件

处理中 (2.55 MB): paper1.pdf
处理中 (3.82 MB): paper2.pdf
⊗ 跳过 (35.03 MB): large_file.pdf
...

✓ Excel文件已生成: D:\PDF文件夹\PDF_Email提取报告.xlsx
================================================================================

摘要:
  总文件数: 11
  成功处理: 10
  跳过文件: 1
  提取Email总数: 9
```

## 技术支持

如有问题，请检查：
1. Python版本是否 >= 3.6
2. 依赖库是否正确安装
3. PDF文件是否可读取（未加密）
